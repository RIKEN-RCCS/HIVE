print('render_envmap')

-- Generate too big sphere as an environment
local gen  = PrimitiveGenerator()
local envmap = gen:Sphere(1000000)

local pm0 = PointModel();
pm0:Create(envmap);
pm0:SetShader("envmap.frag");

-- Generate a sphere
local sphere1 = gen:Sphere(10)
local pm1 = PointModel();
pm1:Create(sphere1);
pm1:SetShader("ibl.frag");

-- load from file
local loader = ImageLoader()
local isloaded = loader:Load("ibl.jpg")
print('Texture Load = ' .. tostring(isloaded))
local img = loader:ImageData()

pm0:SetTexture('mytex0', img) -- Bind
pm1:SetTexture('mytex0', img) -- Bind

local cam = Camera()
cam:SetScreenSize(512, 512)
cam:SetFilename("render_envmap.jpg")
cam:LookAt(
	50, 25, 50,
	0,0,0,
	0,1,0,
	60
)

render({cam, pm0, pm1})
